def foo := average(runtime("foo"))
out foo

def bar := average(runtime("bar"))
out bar

def baz := average(runtime("baz"))
out baz















-- Standard Library
def runtime(name) := {
  def call := function_call(name)
  def return := function_return(name)
  on(return, time(return) - time(call))
}

def on(x,y) := if time(x) == time(y) then y

def sum(x) := {
  def s := default(last(s,x) + x, 0)
  s
}

def average(x) := {
  def c := count(x)
  def safeC := if c == 0 then -1 else c
  sum(x) / safeC
}

def count(x) := {
  def s := default(last(s,x) + 1, 0)
  s
}