in x: Events[Int]
in y: Events[Int]

def xSet := Set.collect(x)
def ySet := Set.collect(y)
def union := Set_union(xSet, ySet)
def intersection := Set_intersection(xSet, ySet)
out union
out intersection

-- stdlib
def Set_collect[T](x: Events[T]) := {
  def set: Events[Set[T]] := default(Set_add(last(set, x), x), Set.empty[T])
  set
}
