in x: Events[Int]

def getCount(counts, key) :=
    if Map_contains(counts, key)
    then Map_get(counts, key)
    else 0

def incCount(counts, key) :=
    Map_add(counts, key, getCount(counts, key) + 1)

def counts := default(incCount(last(counts, x), x), Map_empty)
def size := Map_size(counts)

out x
out counts
out size
